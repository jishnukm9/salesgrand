{% extends "navbar.html" %} {% block content %}


<style>
  /* .pattern-lock {
  position: relative;
  display: flex;
  flex-direction: column;
}

.lock-row {
  display: flex;
}

.lock-btn {
  width: 60px;
  height: 60px;
  margin: 10px;
  border-radius: 50%;
  border: 2px solid #000;
  background-color: #fff;
  outline: none;
}

.lock-btn.active {
  background-color: #4CAF50; 
}

canvas {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
} */



.pattern-lock {
  position: relative;
  display: flex;
  flex-direction: column;
}

.lock-row {
  display: flex;
}

.lock-btn {
  width: 30px;
  height: 30px;
  margin: 5px;
  border-radius: 50%;
  border: 2px solid #000;
  background-color: #fff;
  outline: none;
}

.lock-btn.active {
  background-color: #4CAF50;
}

.line {
  height: 2px; 
  background-color: #4CAF50; 
  position: absolute;
  transform-origin: 0 50%;
}

</style>
<!-- partial -->
<div class="main-panel">
<div class="content-wrapper">
<div class="row">
   <div class="col-sm-12">
      <div class="home-tab">




    

         {% if messages %}
         
      
          {% for message in messages %}
          <div class="alert alert-danger alert-dismissible fade show d-flex justify-content-between " role="alert">
           <p> <strong>{{ message }}</strong> </p> 
            <button type="button" class="close" data-dismiss="alert" aria-label="Close" style="background:none;border:1px solid #444;">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          {% endfor %}
          
         {% endif %}






         <div
            class="d-sm-flex align-items-center justify-content-between border-bottom"
            >
            <nav class="nav nav-borders">
              {% if user.userprofile.role == 'TRC Cleaning and Packing' or user.userprofile.role == 'TRC QC' %}
               <a class="nav-link ps-0 pe-0 ms-0 me-3"style="color:#444;"   href="{% url 'servicecnp' %}">My Service</a>
               <a class="nav-link ps-0 pe-0 ms-3 me-3"style="color:#444;"   href="{% url 'service' %}">All Service List</a>
               {% endif %}

               {% if user.userprofile.role == "TRC Front Desk" %}
               <a class="nav-link ps-0 pe-0 ms-0 me-3"style="color:#444;"   href="{% url 'servicecnp' %}">My Service</a>
               <a class="nav-link ps-0 pe-0 ms-3 me-3"style="color:#444;"   href="{% url 'service' %}">All Service List</a>
               <a class="nav-link ps-0 pe-0 ms-3 me-3" style="color:#444;"  href="{% url 'serviceform' %}">Service Entry</a>
               <a class="nav-link ps-0 pe-0 ms-3 me-3"style="color:#444;"   href="{% url 'servicecompletedfd' %}">Service Completed</a>
               {% endif %}
               



               {% if request.user.userprofile.role == "Franchise Admin" or request.user.userprofile.role == "Branch Admin" %}
               <a class="nav-link ps-0 pe-0 ms-0 me-3"style="color:#444;"   href="{% url 'service' %}">All Service List</a>
               <a class="nav-link ps-0 pe-0 ms-3 me-3" style="color:#444;"  href="{% url 'serviceform' %}">Service Entry</a>
               <a class="nav-link ps-0 pe-0 ms-3 me-3"style="color:#444;"   href="{% url 'servicecompletedfd' %}">Service Completed</a>
               <!-- <a class="nav-link ps-0 pe-0 ms-3 me-3"style="color:#444;"   href="{% url 'sparerequests' %}">Spare Requested</a>
  
                           <a class="nav-link ps-0 pe-0 ms-3 me-3"style="color:#444;"   href="{% url 'servicechargeestimationlist' %}">Service Charge</a> -->
                         
                           {% endif %}

                           {% if user.userprofile.role == "Technician" %}
                           <a class="nav-link active ps-0 pe-0 ms-0 me-3" style="color:#444;"  href="{% url 'service' %}"> My Service </a>
                           <a class="nav-link active ps-0 pe-0 ms-3 me-3" style="color:#444;" href="{% url 'getallservice' %}"> All Service </a>
                           {% endif %}
                           <a class="nav-link active ps-0 pe-0 ms-3 me-3"  style="color: #4555B9 ; border-bottom:2px solid #4555B9;"  href=""> Service Details </a>
            </nav>
            <!-- <hr class="mt-0 mb-4"> -->
         </div>
         <br>




         <div class="servicerefdiv p-4 mb-3" style="background-color:#d7d9e7;border-radius:5px;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">


          <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center gap-3">
              <h5 class="mb-0 fw-bold"><i class="fa-solid fa-screwdriver-wrench me-2"></i>Service Details : <span>{{servicerefnumber}}</span></h5>






              {% if user.userprofile.role == "Technician" %}
              {% if status == "Unacknowledged" or status == "Reassigned" %}
              
                       <div class="">
              
                          <!-- <h5 class="fw-bold mb-3">Choose an Action</h5> -->
              
                          <div class="d-flex">
                          
                          <button data-toggle="modal" data-target=".bd-example-modal-sm" class="service-accept me-1" type="submit">Acknowledge</button>
              
                                      </div>
                       </div>
              
                       <!-- <br> -->
              {% endif %}
              {% endif %}


              <div class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-sm">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title fw-bold" id="exampleModalLabel">Are You Sure?</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>

                    <div class="modal-body d-flex gap-3">
                    <form action="{% url 'acknoledgeservice' %}" method="post">
                      {% csrf_token %}
                      
                                      <input type="text"  name="product1" value="{{item.product}}"  hidden>
                                      <input hidden type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
                                  
                      <input type="text" value="In Progress" name="status" hidden>
                                      <button class="service-accept me-1" type="submit">Acknowledge</button>
                                  </form>

                                  <button type="button" class="btn btn-light me-1 close fw-bold" data-dismiss="modal" aria-label="Close">Cancel</button>
                  </div>
                </div>

               
                </div>
              </div>






              





{% if user.userprofile.role == "TRC QC" or user.userprofile.role == "Technician" %}
{% if status == "Completed" or status == "Beyond Repair" %}
         <div class="">

            <!-- <h5 class="fw-bold mb-3">Choose an Action</h5> -->

            <div class="d-flex">
            

            <button data-toggle="modal" data-target=".bd-example-modal-sm2" class="service-accept me-1" type="submit">Acknowledge</button>

                        </div>
         </div>

         <!-- <br> -->
         {% endif %}
{% endif %}


<div class="modal fade bd-example-modal-sm2" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title fw-bold" id="exampleModalLabel">Are You Sure?</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body d-flex gap-3">
        <form action="{% url 'serviceqcstatusupdate' %}" method="post">
          {% csrf_token %}
          
                          <input type="text"  name="product1" value="{{item.product}}"  hidden>
                          <input hidden type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
                      {% if status == 'Completed' %}
                      <input type="text" value="Quality Checking(Ok)" name="status" hidden>
                      {% elif status == 'Beyond Repair' %}
                      <input type="text" value="Quality Checking(NotOk)" name="status" hidden>
                      {% endif %}
                          <button class="service-accept me-1" type="submit">Acknowledge</button>
                      </form>

                    <button type="button" class="btn btn-light me-1 close fw-bold" data-dismiss="modal" aria-label="Close">Cancel</button>
    </div>
  </div>

 
  </div>
</div>



{% if user.userprofile.role == "Franchise Admin" or user.userprofile.role == "Branch Admin" or user.is_superuser %}
{% if status == "Rejected" %}
         <div class="">

            <!-- <h5 class="fw-bold mb-3">Choose an Action</h5> -->

            <div class="d-flex align-items-center" >
            
              <button data-toggle="modal" data-target=".bd-example-modal-sm3" class="service-accept me-1" >Acknowledge</button>

            <p class="fs-6 ps-1 pt-1">or</p>

            <span data-toggle="modal" data-target="#technicianreassignlistmodal"  class="service-reassign ms-2 nunito-font">Reassign</span>

           

                        </div>
         </div>

       
         {% endif %}
{% endif %}







<div class="modal fade bd-example-modal-sm3" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title fw-bold" id="exampleModalLabel">Are You Sure?</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body d-flex gap-3">
        <form class="me-2" action="{% url 'servicerejectreassign' %}" method="post">
          {% csrf_token %}
          
                          
                          <input hidden type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
                   
                      <input type="text" value="Beyond Repair" name="status" hidden>
                      
                   
                          <button class="service-accept me-1 nunito-font" type="submit">Acknowledge</button>
                      </form>

                    <button type="button" class="btn btn-light me-1 close fw-bold" data-dismiss="modal" aria-label="Close">Cancel</button>
    </div>
  </div>

 
  </div>
</div>





            </div>
            <div>
              {% if user.is_superuser or user.userprofile.role == "TRC Front Desk" or user.userprofile.role == "Franchise Admin" or user.userprofile.role == "Branch Admin" or user.userprofile.role == 'Technician'    %}
              
              <div style="display:inline-block"  data-toggle="tooltip" data-placement="top" title="Print Barcode" >
              <a href="{% url 'printservicebarcode' serviceref=servicerefnumber %}" target="_blank" class="fw-bold"><i class="fa-solid fa-barcode servicecall servicebtns"></i></a>
         </div>
              <div style="display:inline-block"  data-toggle="tooltip" data-placement="top" title="Print Job Sheet/Invoice" >
         
              <a data-toggle="modal" data-target="#serviceprintmodal"   ><i class="fa-solid fa-print servicecall servicebtns"></i></a>
              </div>
              {% if item.status == "CNP Completed(Ok)" or item.status == 'CNP Completed(NotOk)' or item.status == 'Delivered(Ok)' or item.status == 'Delivered(NotOk)' %}
              <div style="display:inline-block"  data-toggle="tooltip" data-placement="top" title="Service Checkout" >
         
                <a  href="{% url 'servicecheckout' servicerefnumber=servicerefnumber %}"   ><i class="fa-solid fa-money-check  servicebtns"></i></a>
                </div>
                {% endif %}
      {% endif %}
      <div style="display:inline-block"  data-toggle="tooltip" data-placement="top" title="Service History" >
        <a href="" data-toggle="modal" data-target="#exampleModalLong"  ><i  class="fa-solid fa-clock-rotate-left servicehistory servicebtns" ></i></a>
      </div>
            
              <a  data-toggle="tooltip" data-placement="top" title="Call Schedule & Details"  href="{% url 'servicecalllogs' serviceref=servicerefnumber %}"><i class="fa-solid fa-phone-volume servicecall servicebtns" ></i></a>
            </div>

            
          </div>
         </div>









         <div class="row">


            <div class="col-lg-8">

                <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;;">
                    <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">

                        <div class="d-flex justify-content-between text-align">
                            <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-brands fa-product-hunt me-2"></i> {{item.product}}</strong> </h5>

                            {% if user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.userprofile.role == 'TRC Front Desk' or user.is_superuser or user.userprofile.role == 'Field Engineer' %}
                            <a data-toggle="modal" data-target="#serviceiteminfo" class="text-dark" href=""><i class="fa-solid fa-pen-to-square"></i></a>
                            {% endif %}
                        </div>
                        
                    </div>
                    <div class="card-body ">

                    <div class="row">
                            <div class="col-lg-3 col-md-3">

                                <div class="mb-5">
                                    <p  class="text-grey ">Brand</p>
                                    
                                    {% if item.brand == None or item.brand == '' %}
                                    <p class=" fs-6 ">_______</p>
                                    {% else %}
                                    <p class="text-dark" style="font-size:15px;font-weight: 500;" >{{item.brand}}</p>
                                    {% endif %}
                                </div>

                                <div class="mb-5">
                                    <p  class="text-grey ">Status</p>
                                    
                                    {% if item.status == None or item.status == '' %}
                                    <p class=" fs-6 ">_______</p>
                                    {% else %}
                                    <p class="text-dark" style="font-size:15px;font-weight: 500;">{{item.status}}</p>
                                    {% endif %}
                                </div>
                                <div class="mb-5">
                                    <p  class="text-grey ">Estimated Date</p>
                                    
                                    {% if expecteddate == None or expecteddate == '' %}
                                    <p class="fs-6 ">_______</p>
                                    {% else %}
                                    <p class="text-dark" style="font-size:15px;font-weight: 500;">{{expecteddate}}</p>
                                    {% endif %}
                                </div>

                                <div class="">
                                  <p  class="text-grey ">Booking Id</p>
                              
                                  {% if item.booking == None or item.booking == '' %}
                                  <p class="fw-bold fs-6 ">_______</p>
                                  {% else %}
                                  <p class="text-dark" style="font-size:15px;font-weight: 500;">{{item.booking}}</p>
                                  {% endif %}
                              </div>
                                


                            </div>
                            <div class="col-lg-3 col-md-3">
                                <div class="mb-5">
                                    <p class="text-grey ">Modal</p>
                                    
                                    {% if item.model == None or item.model == '' %}
                                    <p class="fw-bold fs-6 ">_______</p>
                                    {% else %}
                                    <p class="text-black" style="font-size:15px;font-weight: 500;">{{item.model}}</p>
                                    {% endif %}
                                </div>


                                <div class="mb-5">
                                    <p  class="text-grey ">Estimated Amount</p>
                                    
                                    {% if finalamount == None or finalamount == '' %}
                                    <p class="fw-bold fs-6 ">_______</p>
                                    {% else %}
                                    <p class="text-dark" style="font-size:15px;font-weight: 500;">{{finalamount  | default:0 |floatformat:2}}</p>
                                    {% endif %}
                                </div>

                                <div class="mb-5">
                                  <p  class="text-grey ">Service Charge</p>
                                  
                                  {% if item.servicecharge == None or item.servicecharge == '' %}
                                  <p class="fs-6 ">_______</p>
                                  {% else %}
                                  <p class="text-dark" style="font-size:15px;font-weight: 500;">{{item.servicecharge}}</p>
                                  {% endif %}
                              </div>
                              <div class="">
                                <p  class="text-grey ">Invoice Number</p>
                                {% if item.invoicenumber == None or item.invoicenumber == '' %}
                                <p class="fs-6 ">_______</p>
                                {% else %}
                                <p class="text-dark" style="font-size:15px;font-weight: 500;">{{item.invoicenumber}}</p>
                                {% endif %}
                            </div>

                                
                            </div>
                            <div class="col-lg-3 col-md-3">
                              <div class="mb-5">
                                <p class="text-grey ">Series</p>
                                
                                {% if item.series == None or item.series == '' %}
                                <p class="fw-bold fs-6 ">_______</p>
                                {% else %}
                                <p class="text-dark" style="font-size:15px;font-weight: 500;">{{item.series}}</p>
                                {% endif %}
                            </div>

                                <div class="mb-5">
                                    <p class="text-grey ">IMEI</p>
                                    
                                    {% if item.imei == None or item.imei == '' %}
                                    <p class="fw-bold fs-6 ">_______</p>
                                    {% else %}
                                    <p class="text-dark" style="font-size:15px;font-weight: 500;">{{item.imei}}</p>
                                    {% endif %}
                                </div>

                                <div class="mb-5">
                                    <p  class="text-grey ">Amount Recieved</p>
                                
                                    {% if amountrecieved == None or amountrecieved == '' %}
                                    <p class="fw-bold fs-6 ">_______</p>
                                    {% else %}
                                    <p class="text-dark" style="font-size:15px;font-weight: 500;">{{amountrecieved  | default:0 |floatformat:2}}</p>
                                    {% endif %}
                                </div>

                                
                               
                     

                                
                            </div>
                            <div class="col-lg-3 col-md-3">

                                <div class="mb-5">
                                    <p class="text-grey ">Service ref No.</p>
                                    <p class="text-dark" style="font-size:15px;font-weight: 500;">{{servicerefnumber}}</p>
                                   
                                   
                                </div>

                                <div class="mb-5">
                                    <p class="text-grey ">Recieved Date</p>
                                    <p class="text-dark" style="font-size:15px;font-weight: 500;">{{memodate}}</p>
                                </div>

                                <div class="">
                                  <p  class="text-grey ">Entered By</p>
                              
                                  {% if item.entry_by == None or item.entry_by == '' %}
                                  <p class="fw-bold fs-6 ">_______</p>
                                  {% else %}
                                  <p class="text-dark" style="font-size:15px;font-weight: 500;">{{item.entry_by}}</p>
                                  {% endif %}
                              </div>


                            </div>


                        </div>


                        </div>

                </div>





{% if status == "Completed" or status == "Beyond Repair" or status == "Rejected" or status == "Reassigned" or status == "Quality Checking(Ok)" or status == "Quality Checking(NotOk)" %}
{% if user.userprofile.role == "TRC QC" or user.userprofile.role == "Technician" or user.is_superuser or user.userprofile.role == "Franchise Admin" or user.userprofile.role == "Branch Admin" %}

                <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                  

                        <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)" >

                      <div class="d-flex justify-content-between text-align">
                          <h5 class="m-0 font-weight-bold " > <strong>Info</strong> </h5>


                         
                      </div>
                  </div>
                  <div class="card-body ">





                    <p  class="text-muted" style="font-family:Roboto;">Technician Remark</p>
                     <p class="fs-6" style="font-family:Roboto;">{{technician_remark}}</p>
                     {% if status == 'Beyond Repair' or status == "Rejected" or status == "Reassigned"  %}
                     <hr class="bg-secondary">
                     <p class="text-muted" style="font-family:Roboto;">Code</p>
                     <p class="fs-6" style="font-family:Roboto;">{{reject_code}}</p>
                     {% endif %}


                      </div>

                      </div>

                      {% endif %}
                      {% endif %}








                <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                    <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                        

                        <div class="d-flex justify-content-between text-align">
                            <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-triangle-exclamation me-2"></i>Problem Reported</strong> </h5>


                            {% if user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.userprofile.role == 'TRC Front Desk' or user.is_superuser or user.userprofile.role == 'Field Engineer' %}
                            <a class="text-dark" data-toggle="modal" data-target="#serviceprobleminfo" href=""><i class="fa-solid fa-pen-to-square"></i></a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="card-body ">

                        <ul>
                            
                            <li class="text-black" style="font-size:13px;font-weight: 500;">{{problems}}</li>
                           
                        </ul>


                        </div>

                        </div>



                        <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                            <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                

                                <div class="d-flex justify-content-between text-align">
                                    <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-clipboard me-2"></i>Initial Remarks</strong> </h5>
        
                                    {% if user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.userprofile.role == 'TRC Front Desk' or user.is_superuser or user.userprofile.role == 'Field Engineer' %}
                                    <a class="text-dark" data-toggle="modal" data-target="#serviceremarksinfo" href=""><i class="fa-solid fa-pen-to-square"></i></a>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="card-body ">
        
                                <ul>
                                    
                                    <li class="text-black " style="font-size:13px;font-weight: 500;">{{remarks}}</li>
                                   
                                </ul>
        
        
                                </div>
        
                                </div>




                                <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                                    <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                        <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-camera me-1"></i> Pictures</strong> </h5>
                                    </div>
                                    <div class="card-body ">
                
                                        
                <div class="row">

                                        <div class="col-lg-4 col-md-4">

                                              
     {% if image1 != None and image1 != null and image1 != '' %}
     
     <!-- <img src="{{image1}}" class="zoomable-image"  alt="" id="serviceimage1" width="100%"> -->

     <img src="{{image1}}" class="zoomable-image"  alt="" id="serviceimage1" width="100%">     {% endif %}
            
            
                                        </div>

                                        <div class="col-lg-4 col-md-4">

                                            
                                            {% if image2 != None and image2 != null and image2 != '' %}
     
                                            <!-- <img src="{{image2}}" class="zoomable-image" id="serviceimage2" alt="" width="100%"> -->
                                            <img src="{{image2}}" class="zoomable-image" id="serviceimage2" alt="" width="100%">
                                           
                                            {% endif %}
            
                                        </div>

                                        <div class="col-lg-4 col-md-4">

                                            
                                            {% if image3 != None and image3 != null and image3 != '' %}
     
                                            <!-- <img src="{{image3}}" class="zoomable-image" id="serviceimage3" alt="" width="100%"> -->
                                            <img src="{{image3}}" class="zoomable-image" id="serviceimage3" alt="" width="100%">
                                           {% endif %}
            
                                        </div>



                                       
                                       


                                    </div>

                                    <div class="row mt-4">
                                      <div class="col-lg-4 col-md-4">

                                            
                                        {% if image4 != None and image4 != null and image4 != '' %}
 
                                        <!-- <img src="{{image4}}" class="zoomable-image" id="serviceimage4" alt="" width="100%"> -->

                                        <img src="{{image4}}" class="zoomable-image" id="serviceimage4" alt="" width="100%">
                                       {% endif %}
        
                                    </div>




                                    <div class="col-lg-4 col-md-4">

                                          
                                      {% if image5 != None and image5 != null and image5 != '' %}

                                      <!-- <img src="{{image5}}" class="zoomable-image" id="serviceimage5" alt="" width="100%"> -->

                                      <img src="{{image5}}" class="zoomable-image" id="serviceimage5" alt="" width="100%">
                                     {% endif %}
      
                                  </div>



                                  <div class="col-lg-4 col-md-4">

                                          
                                    {% if image6 != None and image6 != null and image6 != '' %}

                                    <!-- <img src="{{image6}}" class="zoomable-image" id="serviceimage6" alt="" width="100%"> -->

                                    <img src="{{image6}}" class="zoomable-image" id="serviceimage6" alt="" width="100%">
                                   {% endif %}
    
                                </div>
                                    </div>

                                  




                
                                        </div>
                
                                        </div>







                                        {% if user.userprofile.role == "Technician" or user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.is_superuser %}
                                       
                                        {% if status != 'Delivered(Ok)' and status != "Delivered(NotOk)" and status != "Unassigned" and status != "Unacknowledged"  %}


                                        <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                                          <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                              <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-gear me-2"></i>Request Spare Parts</strong> </h5>
                                          
                                          
                                              <!-- <a href=""></a> -->
                                            </div>
                                          <div class="card-body ">


                                          {% if service_charge_estimation == None %}
                                            {% if requested_spares_number == 0 %}
                                            {% if status == 'In Progress' %}
                                          <div class="form-group">
                                            <input type="checkbox" name="no-spare" class="me-1 mt-1" id="no-spare">
                                            <label for="no-spare" class="fw-bold " style="color:#444;">No Spare Parts Required</label>
                                          </div>
                                          {% endif %}
                                          {% endif %}
                                          {% endif %}
                      
                                          <form action="{% url 'addsparerequeststandard' %}" id="sparerequestform" method="post"> 
                                            {% csrf_token %}
                                            <input type="datetime" name="estimateddate" value="{{expecteddate | date:'Y-m-d'}}" hidden>
                                            <input type="datetime" name="servicedate" value="{{memodate | date:'Y-m-d'}}" hidden>
                                            <input type="text" hidden value="{{servicerefnumber}}" name="servicereff" hidden>  
                      <table class="table spare-request-table table-responsive table-bordered">
                        <thead style="background-color: #E8E1D7;">
                          <tr >
                            <th width="2%"></th>
                            <th width="45%;">Spare</th>
                            <th width="10%">Avail. Qty</th>
                            <th width="10%;">Qty</th>
                            <!-- <th>Color</th> -->
                            <th width="23%">Status</th>
                            <th width="10%">Action</th>
                          </tr>
                        </thead>

                        <tbody>
                          <tr>
                            <td>1</td>
                            <td class="">
                              
                              


                              <input
                              type="text"
                              id="req-spare1"
                              autocomplete="off"
                              name="reqspare1"
                              list="reqspare1"
                              class="form-control no-spinner"
                              
                            />
                            <datalist id="reqspare1">
                              {% for spare in all_spares %}
                              <option value="{{spare}}">{{spare}}</option>
                              {% endfor %}
                            </datalist>
                           
                            </td>
                            <td>
                              <input 
                            type="number"
                             class="form-control no-spinner"
                              readonly 
                              value="" 
                               name="availablereqqty1">
                            </td>
                            <td class="">
                              <input type="number" min="1"  name="reqqty1" class="form-control no-spinner" >
                            </td>
                           
                            <td class="">
                              <input type="text" class="form-control" name="status1" value="" readonly>
                            </td>
                            <td class="reqappendbtn">
                              <span class="addbtnsparereq"   ><i class="fa-solid fa-plus"></i></span>
                            </td>
                          </tr>
                          
                        </tbody>

                      </table>
                      <button type="submit" class="btn btn-primary text-white fw-bol">Allocate</button>
      
      
                    </form> 

                    <form action="{% url 'addservicechargestandard' %}" id="nospareform" method="post" style="display:none">
                      {% csrf_token %}
                      <input type="text" hidden value="{{servicerefnumber}}" name="servicereff" hidden> 
                      <input type="text" hidden value="Requested" name="status" hidden> 
                    <button type="submit" class="btn btn-primary text-white fw-bol service-request-btn" >Save</button>
                  </form>  
                  </div>
                      
                                              </div>

{% endif %}
{% endif %}






{% if user.userprofile.role == "Technician" or user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.is_superuser %}



                                        <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                                          <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                              <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-gear me-2"></i>Allocated Spare List</strong> </h5>
                                          </div>
                                          <div class="card-body table-responsive">
                      
                                         
                                           
                                            
                      <table class="table   table-bordered">
                        <thead style="background-color: #E8E1D7;">
                          <tr >
                            <th ></th>
                            <th  style="white-space:normal">Spare Name</th>
                        
                            <th >Qty</th>
                        
                            <th  style="white-space:normal">Date Requested</th>
                            <th >Status</th>
                            <th>Action</th>
                          </tr>
                        </thead>

                        <tbody>
                          {% for spare in requsted_spares %}
                          <tr>
                            <td>{{forloop.counter}}</td>

                            <td style="white-space:normal">{{spare.spare.name}}</td>
                            <td>{{spare.requested_qty}}</td>
                            <td>{{spare.created_date}}</td>
                            <td>{{spare.status}}</td>
                            <td>

                              {% if request.user.userprofile.role == "Franchise Admin" or request.user.userprofile.role == "Branch Admin" or request.user.userprofile.role == "Technician" %}
                              
                              {% if status != "Delivered(Ok)" and status != "Delivered(NotOk)" and status != "Beyond Repair"  %}

                              <a href="{% url 'cancelsparerequeststandard' id=spare.id serviceref=servicerefnumber %}" class="text-danger fw-bold"><i class="fa-solid fa-trash-can"></i></a>
                          {% endif %}
                          {% endif %}
                            </td>
                          </tr>
                          {% endfor %}
                        </tbody>

                      </table>

      
      
               
      
                      
                                              </div>
                      
                                              </div>


{% endif %}









{% if user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.is_superuser %}



                                        <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                                          <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                              <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-sack-dollar me-2"></i>Allocated Spare Cost Details</strong> </h5>
                                          </div>
                                          <div class="card-body table-responsive">
                      
                                         
                                           
                                            
                      <table class="table   table-bordered">
                        <thead style="background-color: #E8E1D7;">
                          <tr >
                            <th ></th>
                            <th  style="white-space:normal" >Spare Name</th>
                        
                            <th  style="white-space:normal">Selling Cost Excluding Tax</th>
                        
                            <th  style="white-space:normal">Selling VAT%</th>
                            <th  style="white-space:normal">Purchase Cost Excluding Tax</th>
                        
                            <th  style="white-space:normal">Purchase VAT%</th>
                          
                          </tr>
                        </thead>

                        <tbody>
                          {% for spare in requsted_spares %}
                          <tr>
                            <td>{{forloop.counter}}</td>

                            <td style="white-space:normal">{{spare.spare.name}}</td>
                            <td>{{spare.price}}</td>
                            <td>{{spare.salegst}}</td>
                            <td>{{spare.purchase_price}}</td>
                            <td>{{spare.purchase_tax}}%</td>
               
                          </tr>
                          {% endfor %}
                        </tbody>

                      </table>

      
      
               
      
                      
                                              </div>
                      
                                              </div>


{% endif %}








                                        {% if status != 'Unacknowledged' or user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.is_superuser  %}

                                        <div class="card mb-2" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                                          <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                              
              
                                              <div class="d-flex justify-content-between text-align">
                                                  <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-comment me-2"></i>Service Informations</strong> </h5>
                      
                      
                                                  <!-- <a class="text-dark" data-toggle="modal" data-target="#serviceremarksinfo" href=""><i class="fa-solid fa-pen-to-square"></i></a> -->
                                                  
                                              </div>
                                          </div>
                                          <div class="card-body ">

                                            <ul class="list-group list-group-flush mb-4">
                                              {% for inf in service_info %}
                                              <li class="list-group-item ps-0">

                                                <p class="text-muted" style="font-family:Roboto;">{{inf.user.username}} ({{inf.user.userprofile.role}}) added a comment on {{inf.created_date}}</p>
                                               <p class="fs-6" style="font-family:Roboto;">{{inf.info}}</p>
                                              
                                              </li>
                                              {% endfor %}


                                             
                                            </ul>
                                           
                      
                                              <form action="{% url 'addserviceinfo' %}" method="post">

                                                  {% csrf_token %}
                                                <div class="form-group">
                                                  <label for="info" class="fw-bold">Enter Information</label>
                                                  <input type="text" hidden value="{{servicerefnumber}}" name="servicereff">
                                  <textarea class="form-control" style="height:106px;" name="info" id="info"  cols="30" rows="10"></textarea>
                                                  
                                                </div>

                                            


<button class="btn btn-primary text-white  fw-bold" type="submit">Save Information</button>



                                              </form>
                      
                      
                                              </div>
                      
                                              </div>

{% endif %}










            </div>


            <div class="col-lg-4">








{% if status == 'QC Failed' or status == 'QC Passed(Ok)' %}
{% if user.is_superuser or user.userprofile.role == 'Branch Admin' or user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Technician' or user.userprofile.role == 'TRC QC'  %}

              <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                    
                    <div class="d-flex justify-content-between text-align">
                        <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong>QC Result</strong> </h5>

                       
                    </div>
                </div>
                <div class="card-body">
               

                   
                  <div class="d-flex justify-content-center">

                  
                    <table class="table">
                      <thead>
                        <tr>
                          <th>Parameter</th>
                          <th class="text-center">Status</th>
                       
                        </tr>

                      </thead>
                      <tbody>
                        {% for param in qcoklist %}
                        <tr>
                          <td>{{param}}</td>
                          <td class="text-center">
                            <i class="fa-solid fa-check qccheckmark"></i>
                          </td>
                        </tr>
                        {% endfor %}

                        {% for param in qcnotoklist %}
                        <tr>
                          <td>{{param}}</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark"></i>
                          </td>
                        </tr>
                        {% endfor %}
                       

                      </tbody>
                    </table>
 
                   

                   
                   
                    </div>
                    {% if status == 'QC Failed' %}

                    <div class="p-0 border">
                      <p class="text-dark p-2 fw-bold" style="background-color: #d7d9e7;">QC Remark</p>
                      <p class="fs-6 p-2" style="font-family:Roboto;">{{qcremark}}</p>
                    </div>

                    {% endif %}
                  
               


                  </div>

            </div>

            {% endif %}
            {% endif %}





{% if status == 'Quality Checking(Ok)' or status == 'Quality Checking(NotOk)' %}
{% if user.userprofile.role == 'TRC QC' or user.userprofile.role == 'Technician' or user.is_superuser or user.userprofile.role == 'Branch Admin' or user.userprofile.role == 'Franchise Admin'  %}

              <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                    
                    <div class="d-flex justify-content-between text-align">
                        <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong>Verify Forum </strong> </h5>


                        <div class="d-flex align-items-center gap-2">
                          <input class="form-check-input check1 " style="margin-top:-10px;" name="checkall" type="checkbox"  id="flexCheckDefaultcheckall">
                          <div><h6 class="nunito-font">Select All</h6></div>
                          
                        </div>
                        
                    </div>
                </div>
                <div class="card-body">
                  <form action="{% url 'verifyqcform' %}" method="post">
                    {% csrf_token %}

                    <input type="text" hidden value="{{servicerefnumber}}" name="servicereff">
                  <div class="d-flex justify-content-center">

                    {% if item.product == "Mobile Phones" %}
                    <table class="table">
                      <thead>
                        <tr>
                          <th>Parameter</th>
                          <th>Status</th>
                          <th>Assign Condition</th>
                        </tr>

                      </thead>
                      <tbody>
                        <tr>
                          <td>Imei</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x1"></i>
                            <i class="fa-solid fa-check qccheckmark c1" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check1" name="check1" type="checkbox" value="Imei" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Physical Condition</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x2"></i>
                            <i class="fa-solid fa-check qccheckmark c2" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check2" name="check2" type="checkbox" value="Physical Condition" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Side Keys and Switches</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x3"></i>
                            <i class="fa-solid fa-check qccheckmark c3" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check3" type="checkbox" name="check3" value="Side Keys and Switches" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Charging</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x4"></i>
                            <i class="fa-solid fa-check qccheckmark c4" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check4" type="checkbox" name="check4" value="Charging" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Ringer</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x5"></i>
                            <i class="fa-solid fa-check qccheckmark c5" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check5" type="checkbox" name="check5" value="Ringer" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Speaker</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x6"></i>
                            <i class="fa-solid fa-check qccheckmark c6" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check6" type="checkbox" name="check6" value="Speaker" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Sim</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x7"></i>
                            <i class="fa-solid fa-check qccheckmark c7" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check7" type="checkbox" name="check7" value="Sim" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Network</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x8"></i>
                            <i class="fa-solid fa-check qccheckmark c8" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check8" type="checkbox" name="check8" value="Network" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Mic</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x9"></i>
                            <i class="fa-solid fa-check qccheckmark c9" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check9" type="checkbox" name="check9" value="Mic" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Vibrator</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x10"></i>
                            <i class="fa-solid fa-check qccheckmark c10" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check10" type="checkbox" name="check10" value="Vibrator" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Hands Free</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x11"></i>
                            <i class="fa-solid fa-check qccheckmark c11" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check11" type="checkbox" name="check11" value="Hands Free" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Touch</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x12"></i>
                            <i class="fa-solid fa-check qccheckmark c12" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check12" type="checkbox" name="check12" value="Touch" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Display</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x13"></i>
                            <i class="fa-solid fa-check qccheckmark c13" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check13" type="checkbox" name="check13" value="Display" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Proximity Sensor</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x14"></i>
                            <i class="fa-solid fa-check qccheckmark c14" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check14" type="checkbox" name="check14" value="Proximity Sensor" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Front Camera</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x15"></i>
                            <i class="fa-solid fa-check qccheckmark c15" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check15" type="checkbox" name="check15" value="Front Camera" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Flash Light</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x16"></i>
                            <i class="fa-solid fa-check qccheckmark c16" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check16" type="checkbox" name="check16" value="Flash Light" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Main Camera</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x17"></i>
                            <i class="fa-solid fa-check qccheckmark c17" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check17" type="checkbox" name="check17" value="Main Camera" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Memory Card</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x18"></i>
                            <i class="fa-solid fa-check qccheckmark c18" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check18" type="checkbox" name="check18" value="Memory Card" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Wifi</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x19"></i>
                            <i class="fa-solid fa-check qccheckmark c19" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check19" type="checkbox" name="check19" value="Wifi" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Bluetooth</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x20"></i>
                            <i class="fa-solid fa-check qccheckmark c20" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check20" type="checkbox" name="check20" value="Bluetooth" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Finger Sensor</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x21"></i>
                            <i class="fa-solid fa-check qccheckmark c21" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check21" type="checkbox" name="check21" value="Finger Sensor" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Face Sensor</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x22"></i>
                            <i class="fa-solid fa-check qccheckmark c22" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check22" type="checkbox" name="check22" value="Face Sensor" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Heating Problem</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x23"></i>
                            <i class="fa-solid fa-check qccheckmark c23" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check23" type="checkbox" name="check23" value="Heating Problem" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Battery Backup</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x24"></i>
                            <i class="fa-solid fa-check qccheckmark c24" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check24" type="checkbox" name="check24" value="Battery Backup" id="flexCheckDefault">
                          </td>

                        </tr>
                       

                      </tbody>
                    </table>
                    {% else %}
                    <table class="table">
                      <thead>
                        <tr>
                          <th>Parameter</th>
                          <th>Status</th>
                          <th>Assign Condition</th>
                        </tr>

                      </thead>
                      <tbody>
                        <tr>
                          <td>Imei</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x1"></i>
                            <i class="fa-solid fa-check qccheckmark c1" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check1" name="check1" type="checkbox" value="Imei" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Physical Condition</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x2"></i>
                            <i class="fa-solid fa-check qccheckmark c2" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check2" name="check2" type="checkbox" value="Physical Condition" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Side Keys and Switches</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x3"></i>
                            <i class="fa-solid fa-check qccheckmark c3" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check3" type="checkbox" name="check3" value="Side Keys and Switches" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Charging</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x4"></i>
                            <i class="fa-solid fa-check qccheckmark c4" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check4" type="checkbox" name="check4" value="Charging" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Ringer</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x5"></i>
                            <i class="fa-solid fa-check qccheckmark c5" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check5" type="checkbox" name="check5" value="Ringer" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Speaker</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x6"></i>
                            <i class="fa-solid fa-check qccheckmark c6" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check6" type="checkbox" name="check6" value="Speaker" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Sim</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x7"></i>
                            <i class="fa-solid fa-check qccheckmark c7" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check7" type="checkbox" name="check7" value="Sim" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Network</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x8"></i>
                            <i class="fa-solid fa-check qccheckmark c8" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check8" type="checkbox" name="check8" value="Network" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Mic</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x9"></i>
                            <i class="fa-solid fa-check qccheckmark c9" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check9" type="checkbox" name="check9" value="Mic" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Vibrator</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x10"></i>
                            <i class="fa-solid fa-check qccheckmark c10" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check10" type="checkbox" name="check10" value="Vibrator" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Hands Free</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x11"></i>
                            <i class="fa-solid fa-check qccheckmark c11" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check11" type="checkbox" name="check11" value="Hands Free" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Touch</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x12"></i>
                            <i class="fa-solid fa-check qccheckmark c12" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check12" type="checkbox" name="check12" value="Touch" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Display</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x13"></i>
                            <i class="fa-solid fa-check qccheckmark c13" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check13" type="checkbox" name="check13" value="Display" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Proximity Sensor</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x14"></i>
                            <i class="fa-solid fa-check qccheckmark c14" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check14" type="checkbox" name="check14" value="Proximity Sensor" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Front Camera</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x15"></i>
                            <i class="fa-solid fa-check qccheckmark c15" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check15" type="checkbox" name="check15" value="Front Camera" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Flash Light</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x16"></i>
                            <i class="fa-solid fa-check qccheckmark c16" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check16" type="checkbox" name="check16" value="Flash Light" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Main Camera</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x17"></i>
                            <i class="fa-solid fa-check qccheckmark c17" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check17" type="checkbox" name="check17" value="Main Camera" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Memory Card</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x18"></i>
                            <i class="fa-solid fa-check qccheckmark c18" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check18" type="checkbox" name="check18" value="Memory Card" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Wifi</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x19"></i>
                            <i class="fa-solid fa-check qccheckmark c19" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check19" type="checkbox" name="check19" value="Wifi" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Bluetooth</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x20"></i>
                            <i class="fa-solid fa-check qccheckmark c20" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check20" type="checkbox" name="check20" value="Bluetooth" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Finger Sensor</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x21"></i>
                            <i class="fa-solid fa-check qccheckmark c21" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check21" type="checkbox" name="check21" value="Finger Sensor" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Face Sensor</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x22"></i>
                            <i class="fa-solid fa-check qccheckmark c22" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check22" type="checkbox" name="check22" value="Face Sensor" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Heating Problem</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x23"></i>
                            <i class="fa-solid fa-check qccheckmark c23" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check23" type="checkbox" name="check23" value="Heating Problem" id="flexCheckDefault">
                          </td>

                        </tr>
                        <tr>
                          <td>Battery Backup</td>
                          <td class="text-center">
                            <i class="fa-solid fa-xmark qcxmark x24"></i>
                            <i class="fa-solid fa-check qccheckmark c24" style="display:none"></i>
                          </td>
                          <td class="text-center">
                            <input class="form-check-input check24" type="checkbox" name="check24" value="Battery Backup" id="flexCheckDefault">
                          </td>

                        </tr>
                       

                      </tbody>
                    </table>
                    {% endif %}
                   
                   
                    </div>
                    <input type="checkbox" name="faultnofault" id="faultnofault" value="fault"  hidden>
                    <button type="submit" class="btn btn-primary text-white fw-bold w-100 qc-verify-btn mt-3">Verify</button>
                 
                    <a class="btn btn-primary text-white initial-fault-btn fw-bold w-100" >Fault Detected</a>

                    <div class="form-group mt-4 qcfaultremarkdiv" style="display:none;">
                      <div class="d-flex justify-content-between">
                      <label class="fw-bold" for="qcfaultremark">Remark</label><span><i class="fa-solid fa-xmark qcxmark qcxmarkremark"></i></span>
                    </div>
                      <input type="text" name="qcfaultremark" class="form-control   border-0 border-bottom">
                    </div>

                    <button type="submit" class="btn  text-white final-fault-btn fw-bold w-100" style="display:none;">Fault Detected</button>
                  
                  </form>


                  </div>

            </div>

            {% endif %}
            {% endif %}























              {% if user.userprofile.role == "Technician" or user.is_superuser or user.userprofile.role == "Franchise Admin" or user.userprofile.role == "Branch Admin"  %}
              {% if status == "Spare Allocated" or status == "QC Failed" or status == 'In Progress' %}
              <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                    
                    <div class="d-flex justify-content-between text-align">
                        <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-circle-check me-2"></i>Complete Service</strong> </h5>


                        <!-- <a class="text-dark" data-toggle="modal" data-target="#servicecustomerinfo" href=""><i class="fa-solid fa-pen-to-square"></i></a> -->
                        
                    </div>
                </div>
                <div class="card-body ">


                  <form action="{% url 'addservicecompletereject' %}" method="post">
{% csrf_token %}

<input type="text" hidden value="{{servicerefnumber}}" name="servicereff">

<div class="d-flex gap-5 align-items-center ps-4">
  {% if status != 'In Progress' %}
                  <div class="form-check">
                    <input class="form-check-input" type="radio" value="Completed" name="oknotok" id="ok" checked>
                    <label class="form-check-label ms-0 pt-1" for="ok">
                      Serviced
                    </label>
                  </div>
                
                  <div class="form-check">
                    <input class="form-check-input" type="radio" value="Rejected" name="oknotok" id="notok" >
                    <label class="form-check-label ms-0 pt-1" for="notok">
                      Not Serviced
                    </label>
                  </div>
                  {% else %}
                  <div class="form-check">
                    <input class="form-check-input" type="radio" value="Rejected" name="oknotok" id="notok" checked>
                    <label class="form-check-label ms-0 pt-1" for="notok">
                      Not Serviced
                    </label>
                  </div>
                  {% endif %}


                 

                </div>


                <select class="form-control mt-4 border-bottom" name="notokcode" id="notokcode" style="display:none;">
                  <option value="" >Select Reject Code</option>
                  <option value="IRB">IRR</option>
                  <option value="WL">WL</option>
                  <option value="BER">BER</option>
                  <option value="SNA">SNA</option>
                  <option value="CNW">CNW</option>
                </select>


                <div class="form-group mt-4 ">
                  <label class="fw-bold" for="servicecompleteremark">Remark</label>
                  <input type="text" name="servicecompleteremark" class="form-control   border-0 border-bottom">
                </div>
                

                <button class="btn btn-primary text-white fw-bold w-100" type="submit">Complete Service</button>
                
                
              </form>

              

                    

                    </div>

            </div>
            {% endif %}
            {% endif %}











                <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                    <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                        
                        <div class="d-flex justify-content-between text-align">
                            <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-user me-2"></i>Customer Details </strong> </h5>

                            {% if user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.userprofile.role == 'TRC Front Desk' or user.is_superuser or user.userprofile.role == 'Field Engineer' %}
                            <a class="text-dark" data-toggle="modal" data-target="#servicecustomerinfo" href=""><i class="fa-solid fa-pen-to-square"></i></a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="card-body ">


                        <div class="">
                            
                            <p class="fw-bold fs-5 mb-3 text-success" style="">{{firstname | title}} {{lastname}}</p>

                  
                            <p class="  mb-2"  style="font-size:15px;font-weight: 500;"><i class="fa-solid fa-phone" style="margin-right:6px;"></i> <span style="color:#444;">{{phone}}</span> </p>
                            <p class=" mb-2"  style="font-size:15px;font-weight: 500;"><i class="fa-solid fa-location-dot" style="margin-right:10px;"></i> <span style="color:#444;">{{address}}</span> </p>
  
 
                            <p class="  mb-2"  style="font-size:15px;font-weight: 500;"><i class="fa-solid fa-id-card" style="margin-right:5px;"></i> <span style="color:#444;">{{customerid}}</span> </p>
                            
                            
                        </div>

                        </div>

                </div>



                <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                    <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                        
                        <div class="d-flex justify-content-between text-align">
                            <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-headphones-simple me-2"></i>Accessories Attached</strong> </h5>

                            {% if user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.userprofile.role == 'TRC Front Desk' or user.is_superuser or user.userprofile.role == 'Field Engineer' %}
                            <a class="text-dark" data-toggle="modal" data-target="#serviceaccessoriesinfo" href=""><i class="fa-solid fa-pen-to-square"></i></a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="card-body">

                        <ul>
                            {% for item in accessories %}
                            <li class="text-black" style="font-size:13px;font-weight: 500;">{{item}}</li>
                            {% endfor %}
                        </ul>



                        </div>

                        </div>





                        <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                            <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                
                                <div class="d-flex justify-content-between text-align">
                                    <div class="d-flex gap-2">
                                        <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-users me-2"></i>Technician</strong> </h5>
                                        {% if user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.is_superuser %}
                                        <!-- <i class="fa-solid fa-circle-info" data-toggle="modal" data-target="#technicianmodal"></i> -->
                                        <i class="fa-solid fa-eye" data-toggle="modal" data-target="#technicianmodal"></i>
                                   {% endif %}
                                    </div>


                                    
                                    
        
                                    {% if technician == None  %}
                                    {% if user.is_superuser or user.userprofile.role == "Franchise Admin" or user.userprofile.role == "Branch Admin" %}
                                    <a class="assign-btn" data-toggle="modal" data-target="#technicianlistmodal"  href="">Assign</a>
                                    {% endif %}
                                    {% endif %}


                                    {% if status == 'Unacknowledged' %}
                                    {% if user.is_superuser or user.userprofile.role == "Franchise Admin" or user.userprofile.role == "Branch Admin" %}
                                    <a class="assign-btn" data-toggle="modal" data-target="#technicianlistmodal"  href="">Reassign</a>
                                    {% endif %}
                                    {% endif %}
                                </div>
                            </div>
                            <div class="card-body">
        
                                
        
                                <ul>
                                    <li class="text-dark" style="font-size:13px;font-weight: 500;">{{technician}}</li>
                                </ul>
        
                                </div>
        
                                </div>



                                <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                                  <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                      
                                      <div class="">
                                          <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-headphones-simple me-2"></i>Screen Lock Pattern</strong> </h5>
              
                                        
                                      </div>
                                  </div>
                                  <div class="card-body d-flex justify-content-center align-items-center flex-column">




                                    <div>
                                      
                                      <!-- <div id="patternLock" class="pattern-lock">
                                        <canvas id="lockCanvas"></canvas>
                                        <div class="lock-row">
                                          <button class="lock-btn" data-num="1"></button>
                                          <button class="lock-btn" data-num="2"></button>
                                          <button class="lock-btn" data-num="3"></button>
                                        </div>
                                        <div class="lock-row">
                                          <button class="lock-btn" data-num="4"></button>
                                          <button class="lock-btn" data-num="5"></button>
                                          <button class="lock-btn" data-num="6"></button>
                                        </div>
                                        <div class="lock-row">
                                          <button class="lock-btn" data-num="7"></button>
                                          <button class="lock-btn" data-num="8"></button>
                                          <button class="lock-btn" data-num="9"></button>
                                        </div>
                                      </div> -->
                                      <div id="patternLock" class="pattern-lock">
                                        <div class="lock-row">
                                          <button class="lock-btn" data-num="1">1</button>
                                          <button class="lock-btn" data-num="2">2</button>
                                          <button class="lock-btn" data-num="3">3</button>
                                        </div>
                                        <div class="lock-row">
                                          <button class="lock-btn" data-num="4">4</button>
                                          <button class="lock-btn" data-num="5">5</button>
                                          <button class="lock-btn" data-num="6">6</button>
                                        </div>
                                        <div class="lock-row">
                                          <button class="lock-btn" data-num="7">7</button>
                                          <button class="lock-btn" data-num="8">8</button>
                                          <button class="lock-btn" data-num="9">9</button>
                                        </div>
                                      </div>


                                    </div>
              
                                      <ul class="list-unstyled mt-4">
                                        {% if pattern %}
                                          <li class="text-black " style="font-size:13px;font-weight: 500;">Pattern order : {{pattern}}</li>
                                          {% endif %}
                                      </ul>

                                      <ul class="list-unstyled mt-0">
                                          {% if item.screen_password %}
                                        <li class="text-black " style="font-size:13px;font-weight: 500;">Screen password : {{item.screen_password}}</li>
                                        {% endif %}
                                    </ul>
              
              
              
                                      </div>
              
                                      </div>

                                      


                                {% if status == 'CNP Completed(Ok)' or status == 'CNP Completed(NotOk)' %}
                                <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                                  <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                      
                                      <div class="d-flex justify-content-between text-align">
                                          <div class="d-flex gap-2">
                                              <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-box-open me-2"></i>Rack Number</strong> </h5>
                                              
                                          </div>
      
      
                                          
                                          
              
                                         
                                      </div>
                                  </div>
                                  <div class="card-body">
              
                                      
              
                                      <ul>
                                          <li class="text-dark" style="font-size:13px;font-weight: 500;">{{rack_number}}</li>
                                      </ul>
              
                                      </div>
              
                                      </div>
                                      {% endif %}




{% if item.customer_gst_number %}
                                      <div class="card mb-4" style="border-radius:5px;border:0.5px solid #e2e2e2;box-shadow: rgba(17, 17, 26, 0.1) 0px 0px 16px;">
                                        <div class="card-header py-3" style="background-color: rgba(89, 99, 158, 0.24)">
                                            
                                            <div class="d-flex justify-content-between text-align">
                                                <h5 class="m-0 font-weight-bold " style="color:#2c2e2f"> <strong><i class="fa-solid fa-receipt me-2"></i>Customer VAT Number</strong> </h5>
                    
                                                {% if user.userprofile.role == 'Franchise Admin' or user.userprofile.role == 'Branch Admin' or user.userprofile.role == 'TRC Front Desk' or user.is_superuser or user.userprofile.role == 'Field Engineer' %}
                                                <a class="text-dark" data-toggle="modal" data-target="#" href=""><i class="fa-solid fa-pen-to-square"></i></a>
                                                {% endif %}
                                            </div>
                                        </div>
                                        <div class="card-body">
                    
                                            <ul>
                                               
                                                <li class="text-black" style="font-size:13px;font-weight: 500;">{{item.customer_gst_number}}</li>
                                               
                                            </ul>
                    
                    
                    
                                            </div>
                    
                                            </div>
{% endif %}



                
            </div>






         </div>



         











       
         
  


      
      

      
        </div>
   </div>
</div>
<!-- </div>
   </div>
   </div> -->




<div class="modal fade" tabindex="-1" id="serviceprintmodal">
   <div class="modal-dialog">
     <div class="modal-content p-0 w-100">
       <div
         class="modal-header d-flex justify-content-between align-items-center "
         style="background-color:#4555B9;"
       >
         <h5 class="modal-title text-white"><strong>Print</strong></h5>
         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span class="text-white" aria-hidden="true">&times;</span>
          </button>
       </div>
       <!-- <hr class="horizontal-line" /> -->
       <div class="modal-body">
       <form action="{% url 'serviceprintpage' serviceref=servicerefnumber %}" id="serivceorderivoiceform"  method="POST">
         {% csrf_token %}
        

         <div
                          class="modal-body mt-3 mb-3 "
                          style="
                          padding-top: 0px;
                          padding-bottom: 0px;
                      " >

                        
                
              
{% if status == 'Delivered(Ok)' or status == 'Delivered(NotOk)' or status == 'CNP Completed(Ok)' or status == 'CNP Completed(NotOk)'  %}
<div class="form-check d-flex justify-content-center align-items-center">
  <div class="w-50">
<input class="form-check-input" type="radio" name="flexRadioDefault" value="invoice" id="flexRadioDefault1" checked >
<label class="form-check-label text-left" for="flexRadioDefault1" style="text-align:left;">
  Invoice
</label>
</div>
</div>
{% endif %}
<div class="form-check d-flex justify-content-center align-items-center">
   <div class="w-50">
  <input class="form-check-input" type="radio" name="flexRadioDefault" value="order" id="flexRadioDefault1" checked >
  <label class="form-check-label text-left" for="flexRadioDefault1" style="text-align:left;">
    Job Sheet
  </label>
</div>
</div>


                       


                
                    

                        
                         
                         

                       
                         
                        </div>
                    
       
      </div>

      <div class="modal-footer">
         <button type="submit"  class="btn btn-primary  border-0 p-2 ps-3 pe-3">
            Print
          </button>
      </div>
      </form>
       <!-- <hr class="horizontal-line" /> -->
     </div>
   </div>
 </div>








<div class="modal " tabindex="-1" id="myModals">
   <div class="modal-dialog">
     <div class="modal-content p-0 w-100">
       <div
         class="modal-head text-white d-flex justify-content-between align-items-center "
         style="background-color:#4555B9;"
       >
         <h5 class="modal-title"><strong></strong></h5>
         <button
           type="button"
           id="cancelButton2"
           class="btn-close text-white"
           data-bs-dismiss="modal"
           aria-label="Close"
         ></button>
       </div>
       <hr class="horizontal-line" />





      








       <form action="{% url 'servicecompleterack' %}" id="serivceorderivoiceform2"  method="POST">
         {% csrf_token %}
<div class="p-3" >

   


   <input type="text" hidden value="{{servicerefnumber}}" name="servicereff">
       <div class="form-group  col-lg-12 mt-3 "  >

         <div style="text-align:left;">
         <label class="mb-3 " for="accessories2"
         ><strong>Accessories Attached</strong></label
       >
      </div>
       <div class=" row-fluid" >

         <div class="p-1 border" style="border-radius:5px;" >
        
             <input type="checkbox" name="2accessory[battery]" data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Battery"> <span style="font-size:14px;">Battery </span>                                                             
                   <input type="checkbox" name="2accessory[charger]" data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Charger"> <span style="font-size:14px;">Charger </span>                                  
                  <input type="checkbox" name="2accessory[SIM]" data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="SIM"><span style="font-size:14px;">SIM   </span>  
                      <input type="checkbox" name="2accessory[memory]" data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Memory Card">  <span style="font-size:14px;">Memory Card  </span>   
                                                           </div>



       </div>
      
     
      
     </div>

     <div class="form-group col-lg-12"  >
<div style="text-align:left;">
      <label class="mb-3 text-left" for="rackno"
      ><strong>Rack Number</strong></label
    >
   </div>

    <div class=" row-fluid mb-3" >

     <select required class="form-control selectizefield" name="rackno" id="rackno">
      <option value=""></option>
      {% for i in rack_nos %}
      <option value="{{i.name}}">{{i.name}}</option>
   
      {% endfor %}

     </select>



    </div>
   
  <div style="text-align:left;">
    <button class="btn btn-primary text-white" type="submit">Save</button>
   </div>
  </div>

 

   </div>
       

</form>
       <hr class="horizontal-line" />
     </div>
   </div>
 </div>





<div class="modal fade" tabindex="-1" id="technicianmodal">
   <div class="modal-dialog">
     <div class="modal-content p-0 w-100">
       <div
         class="modal-header d-flex justify-content-between align-items-center "
         style="background-color:#4555B9;"
       >
         <h5 class="modal-title text-white"><strong>Work Status</strong></h5>
         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span class="text-white" aria-hidden="true">&times;</span>
          </button>
       </div>
     
       
         <div class="modal-body">
 
         
         
           <table class="table table-bordered">
          
 {% for key,value in technician_status.items %}
               <tr>
                 <th class="fw-bold" rowspan="4">{{key}}</th>
          
                 <td class="fw-bold status-assigned">Unacknowledged : {{value.Unacknowledged}}</td>
               </tr>
               <tr>
                 <td class="fw-bold status-progress" >In Progress : {{value.InProgress}}</td>
               </tr>
               <!-- <tr>
                 <td class="fw-bold status-completed" >Completed : {{value.Completed}}</td>
               </tr>
            
               <tr>
                 <td class="fw-bold status-rejected" >Rejected : {{value.Rejected}}</td>
               </tr> -->
               <tr>
                <td class="fw-bold status-rejected" >Spare Requested : {{value.SpareRequested}}</td>
              </tr>
              <tr>
                <td class="fw-bold status-rejected" >Spare Allocated : {{value.SpareAllocated}}</td>
              </tr>
               
 
 {% endfor %}
 
           </table>
             
              
 
 
            
          </div>

     </div>
   </div>
 </div>















 <div class="modal fade" tabindex="-1" id="stockmodal">
   <div class="modal-dialog">
     <div class="modal-content w-100">
       <div
         class="modal-header d-flex justify-content-between align-items-center m"
       >
         <h5 class="modal-title"><strong>Available Stocks</strong></h5>
         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
       </div>
     
       
         <div class="modal-body">
 
         
            
            
 
            <table class="table add-pagination-modal table-bordered w-100 m-0">
               <thead>
                 <tr>
                   <td>Product</td>
                   <td>Quantity</td>
                 </tr>
               </thead>
            <tbody>
   {% for key,value in stock_list.items %}
                 <tr>
                   <td >{{key}}</td>
                   <td>{{value}}</td>
                 </tr>
                
   
   {% endfor %}
   </tbody>
   
             </table>
             
              
 
 
            
          </div>
 
     </div>
   </div>
 </div>










 <div class="modal fade" tabindex="-1" id="serviceiteminfo">
    <div class="modal-dialog">
      <div class="modal-content w-100 p-0">
        <div
          class="modal-header d-flex justify-content-between align-items-center text-white"
          style="background-color:#4555B9;"
        >
          <h5 class="modal-title"><strong>{{item.product}}</strong></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span class="text-white" aria-hidden="true">&times;</span>
           </button>
        </div>
      
        <form class="track-changes-form" action="{% url 'serviceupdate'  %}" method="POST">
          {% csrf_token %}
          <div class="modal-body">

           
            <input type="text" name="changedattribute" id="changedattribute" hidden>

            <input type="text"  name="product1" value="{{item.product}}"  hidden>
            <!-- <input type="text"  name="refnumber" value="{{servicerefnumber}}"  > -->
            <div class="form-group">
                <label for="brand" class="fw-bold">Service ref No.</label>
                

                <input type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
              </div>
            <div class="form-group">
                <label for="brand" class="fw-bold">Brand</label>
                

                <input type="text" class="form-control text-center" value="{{item.brand}}" data-name="Brand" name="brand1" >
              </div>

              <div class="form-group">
                <label for="brand" class="fw-bold">Modal</label>
                

                <input type="text" class="form-control text-center" value="{{item.model}}" data-name="Modal" name="model1" id="model1">
              </div>
              
              <div class="form-group">
                <label for="brand" class="fw-bold">IMEI</label>
                

                <input type="text" required class="form-control text-center" value="{{item.imei}}" data-name="IMEI" name="imei1" id="imei1">
              </div>





   



              <div class="form-group pausereason" style="display:none;">
                <label for="pausereason" class="fw-bold">Pause Reason</label>
            <textarea class="form-control pausereasontextarea text-center" style="height:106px;" value="{{pause_reason}}" name="pausereason" id="pausereason"  cols="30" rows="10">{{pause_reason}}</textarea>
            </div>


            <div class="form-group rejectreason" style="display:none;">
                <label for="rejectreason" class="fw-bold">Reject Reason</label>
            <textarea class="form-control rejectreasontextarea text-center" style="height:106px;" value="{{reject_reason}}" name="rejectreason" id="rejectreason"  cols="30" rows="10">{{reject_reason}}</textarea>
            </div>


              
  
               <div class="form-group">
                 <label for="date"  class="fw-bold">Estimated Date</label>
                 <div id="datepicker" 
                 name=""
    class="input-group date datepicker-field " 
    data-date-format="dd-mm-yyyy">
   <input class="form-control  " 
   name="estimateddate"
   value="{{expecteddate | date:'d-m-Y'}}"
   autocomplete="off" 
   id="estimateddate"
   data-name="Estimated Date"
  
  style="text-align:center;"
          type="text"   />
   <span class="input-group-addon">
       <i class="glyphicon glyphicon-calendar"></i>
   </span>
  </div>
               </div>



               <div class="form-group">
                <label for="brand" class="fw-bold">Estimated Amount</label>
                

                <input type="number" readonly step="0.01" min="0" class="form-control text-center" value="{{finalamount}}" name="finalamount" id="finalamountupdt">
                <!-- <input type="number" step="0.01" min="0" class="form-control text-center" value="{{finalamount}}" name="serviceprice1" id="serviceprice1"> -->
             
            </div>



              <div class="form-group">
                <label for="brand" class="fw-bold">Amount Recieved</label>
                
                <input value="{{amountrecieved}}" min="0" class="border p-1 w-100 " type="number" step="0.01" id="amountrecievedupdatehiddenupdt" name="amountrecievedupdatehiddenupdt" value="0" hidden>
                <input type="number" readonly step="0.01" min="0" class="form-control text-center" value="{{amountrecieved}}" name="amountrecievedupdate" id="amountrecievedupdt">
              </div>




              <div class="form-group">
                <label for="brand" class="fw-bold">Due Balance</label>
                

                <input type="number" step="0.01" min="0" class="form-control text-center"  value="{{duebalance}}" name="duebalance" id="duebalanceupdt" readonly>
              </div>


              <!-- <div class="form-group">
                <label for="brand" class="fw-bold">Payment Mode</label>
                
                <select class="selectizefield" name="paymentmode" id="paymentmode">
                    <option value="Cash">Cash</option>
                </select>
                
              </div> -->

              

     
              
           </div>
           <div class="modal-footer">
             <button type="submit" class="btn btn-primary">Save</button>
           </div>
        </form>
      </div>
    </div>
  </div>











  <div class="modal fade" tabindex="-1" id="serviceprobleminfo">
    <div class="modal-dialog">
      <div class="modal-content p-0 w-100">
        <div
          class="modal-header d-flex justify-content-between align-items-center text-white"
          style="background-color:#4555B9;"
        >
          <h5 class="modal-title"><strong>Problem Reported</strong></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span class="text-white" aria-hidden="true">&times;</span>
           </button>
        </div>
      
        <form class="track-changes-form" action="{% url 'serviceupdate'  %}" method="POST">
          {% csrf_token %}
          <div class="modal-body">
            <input type="text" name="changedattribute" id="changedattribute2" hidden>
            <input type="text"  name="product1" value="{{item.product}}"  hidden>
            
            <div class="form-group">
                <label for="brand" class="fw-bold">Service ref No.</label>
                

                <input type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
              </div>
            




              <div class="form-group">
                <label for="brand" class="fw-bold">Problem Reported</label>
                
<textarea class="form-control text-center" style="height:106px;" name="problem" data-name="Problem Reported" id="problem" value="{{problems}}" cols="30" rows="10">{{problems}}</textarea>
                <!-- <input type="text" class="form-control text-center"  value="{{problems}}" name="problem" id="problem" > -->
              </div>

              

     
              
           </div>
           <div class="modal-footer">
             <button type="submit" class="btn btn-primary">Save</button>
           </div>
        </form>
      </div>
    </div>
  </div>






  <div class="modal fade" tabindex="-1" id="serviceremarksinfo">
    <div class="modal-dialog">
      <div class="modal-content p-0 w-100">
        <div
          class="modal-header d-flex justify-content-between align-items-center text-white"
          style="background-color:#4555B9;"
        >
          <h5 class="modal-title"><strong>Initial Remarks</strong></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span class="text-white" aria-hidden="true">&times;</span>
           </button>
        </div>
      
        <form class="track-changes-form" action="{% url 'serviceupdate'  %}" method="POST">
          {% csrf_token %}
          <div class="modal-body">
            <input type="text" name="changedattribute" id="changedattribute3" hidden>
            <input type="text"  name="product1" value="{{item.product}}"  hidden>
            <!-- <input type="text"  name="refnumber" value="{{servicerefnumber}}"  > -->
            <div class="form-group">
                <label for="brand" class="fw-bold">Service ref No.</label>
                

                <input type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
              </div>
            




              <div class="form-group">
                <label for="brand" class="fw-bold">Initial Remarks</label>
                
<textarea class="form-control text-center" style="height:106px;" name="remarks" data-name="Initial Remarks" id="remarks" value="{{remarks}}" cols="30" rows="10">{{remarks}}</textarea>
                <!-- <input type="text" class="form-control text-center"  value="{{problems}}" name="problem" id="problem" > -->
              </div>

              

     
              
           </div>
           <div class="modal-footer">
             <button type="submit" class="btn btn-primary">Save</button>
           </div>
        </form>
      </div>
    </div>
  </div>








  <div class="modal fade" tabindex="-1" id="servicecustomerinfo">
    <div class="modal-dialog">
      <div class="modal-content w-100 p-0">
        <div
          class="modal-header d-flex justify-content-between align-items-center text-white"
          style="background-color:#4555B9;"
        >
          <h5 class="modal-title"><strong>Customer Details</strong></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span class="text-white" aria-hidden="true">&times;</span>
           </button>
        </div>
      
        <form class="track-changes-form" action="{% url 'serviceupdate'  %}" method="POST">
          {% csrf_token %}
          <div class="modal-body">
            <input type="text" name="changedattribute" id="changedattribute4" hidden>
            <input type="text"  name="product1" value="{{item.product}}"  hidden>
            <!-- <input type="text"  name="refnumber" value="{{servicerefnumber}}"  > -->
            <div class="form-group">
                <label for="brand" class="fw-bold">Service ref No.</label>
                

                <input type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
              </div>
            




              <div class="form-group">
                <label for="brand" class="fw-bold">First Name</label>
                

                <input type="text" class="form-control text-center" data-name="First Name"  value="{{firstname}}" name="firstnameservice" id="firstnameservice" >
              </div>


              <div class="form-group">
                <label for="brand" class="fw-bold">Last Name</label>
                

                <input type="text" class="form-control text-center" data-name="Last Name"  value="{{lastname}}" name="lastnameservice" id="lastnameservice" >
              </div>

              <div class="form-group">
                <label for="brand" class="fw-bold">Phone</label>
                

                <input type="number" min="0" class="form-control text-center" data-name="Phone Number"  value="{{phone}}" name="mobilenumber" id="mobilenumber" >
              </div>



              <div class="form-group">
                <label for="brand" class="fw-bold">Address</label>
                
                <textarea class="form-control text-center" style="height:106px;" data-name="Address" name="addressservice" id="addressservice" value="{{address}}" cols="30" rows="10">{{address}}</textarea>

              </div>

              

              
              
           </div>
           <div class="modal-footer">
             <button type="submit" class="btn btn-primary">Save</button>
           </div>
        </form>
      </div>
    </div>
  </div>










  <div class="modal fade" tabindex="-1" id="serviceaccessoriesinfo">
    <div class="modal-dialog">
      <div class="modal-content p-0 w-100">
        <div
          class="modal-header d-flex justify-content-between align-items-center text-white"
          style="background-color:#4555B9;"
        >
          <h5 class="modal-title"><strong>Accessories</strong></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span class="text-white" aria-hidden="true">&times;</span>
           </button>
        </div>
      
        <form class="track-changes-form"  action="{% url 'serviceupdate'  %}" method="POST">
          {% csrf_token %}
          <div class="modal-body">
            <input type="text" name="changedattribute" id="changedattribute5" hidden>
            <input type="text"  name="product1" value="{{item.product}}"  hidden>
            <!-- <input type="text"  name="refnumber" value="{{servicerefnumber}}"  > -->
            <div class="form-group">
                <label for="brand" class="fw-bold">Service ref No.</label>
                

                <input type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
              </div>

              <div class="form-group  col-lg-12 mt-3 "  >

                <div style="text-align:center;">
                <label class="mb-3 " for="accessories2"
                ><strong>Accessories Attached</strong></label
              >
             </div>
              <div class=" row-fluid" >
       
                <div class="p-1 border" style="border-radius:5px;" >
                    {% if 'Battery' in accessories %}
                    <input type="checkbox" checked name="accessory[battery]"  data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Battery"> <span style="font-size:14px;">Battery </span>                                                             
                    {% else %}
                    <input type="checkbox"  name="accessory[battery]"  data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Battery"> <span style="font-size:14px;">Battery </span>                                                             
                        {% endif %}

                        {% if 'Charger' in accessories %}
                        <input type="checkbox" checked name="accessory[charger]"  data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Charger"> <span style="font-size:14px;">Charger </span>                                  
                        {% else %}
                    <input type="checkbox" name="accessory[charger]"  data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Charger"> <span style="font-size:14px;">Charger </span>                                  
                        {% endif %}
                    
                        {% if 'SIM' in accessories %}
                        <input type="checkbox" checked name="accessory[SIM]"  data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="SIM"><span style="font-size:14px;">SIM   </span>   
                        {% else %}
                    <input type="checkbox" name="accessory[SIM]"  data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="SIM"><span style="font-size:14px;">SIM   </span>  
                            {% endif %}

                            {% if 'Memory Card' in accessories %}
                            <input type="checkbox" checked name="accessory[memory]"  data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Memory Card">  <span style="font-size:14px;">Memory Card  </span>   
                            {% else %}
                    <input type="checkbox" name="accessory[memory]"  data-name="Accessories Attached" style=" margin:0 5px 0 10px;" id="accessory2" value="Memory Card">  <span style="font-size:14px;">Memory Card  </span>   
                                 {% endif %}   
                </div>
       
       
       
              </div>
             
            
             
            </div>
            




              

              

     
              
           </div>
           <div class="modal-footer">
             <button type="submit" class="btn btn-primary">Save</button>
           </div>
        </form>
      </div>
    </div>
  </div>








  <div class="modal fade" id="zoomModal" tabindex="-1" role="dialog" aria-labelledby="zoomModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="zoomModalLabel">Zoomed Image</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <img id="zoomedImg" src="" class="img-fluid" alt="Zoomed Image">
            </div>
        </div>
    </div>
</div>







<div class="modal fade" tabindex="-1" id="technicianlistmodal">
    <div class="modal-dialog">
      <div class="modal-content p-0 w-100">
        <div
          class="modal-header d-flex justify-content-between align-items-center m"
          style="background-color:#4555B9;"
        >
          <h5 class="modal-title text-white"><strong>Assign Work</strong></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span class="text-white" aria-hidden="true">&times;</span>
           </button>
        </div>
      
        <form action="{% url 'serviceassignreassign' %}" method="POST">
          {% csrf_token %}
          <div class="modal-body">

            <input type="text"  name="product1" value="{{item.product}}"  hidden>
            <!-- <input type="text"  name="refnumber" value="{{servicerefnumber}}"  > -->
            <input type="text" class="form-control text-center" value="Unacknowledged"  name="status" id="status" hidden>
            <div class="form-group">
                <label for="brand" class="fw-bold">Service ref No.</label>
                

                <input type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
              </div>
            

              <div class="form-group">
                <label for="brand" class="fw-bold">Technician</label>
                
                <select class="form-control selectizefield " name="technician" id="technician" style="border:1px solid #cccccc;box-shadow: inset 0 1px 1px #00000013;">
                    <option value="{{technician.username}}" selected>{{technician}}</option>
                    {% for technicians in technician_list_new %}
                    <option value="{{technicians.username}}">{{technicians.username}} - {{technicians.pending}} Pending</option>
                    {% endfor %}
                    
                                  </select>
                
              </div>

           </div>
           <div class="modal-footer">
             <button type="submit" class="btn btn-primary">Save</button>
           </div>
        </form>
      </div>
    </div>
  </div>











  <div class="modal fade" tabindex="-1" id="technicianreassignlistmodal">
    <div class="modal-dialog">
      <div class="modal-content p-0 w-100">
        <div
          class="modal-header d-flex justify-content-between align-items-center m"
          style="background-color:#4555B9;"
        >
          <h5 class="modal-title text-white"><strong>Reassign Work</strong></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span class="text-white" aria-hidden="true">&times;</span>
           </button>
        </div>
      
        <form action="{% url 'serviceassignreassign' %}" method="POST">
          {% csrf_token %}
          <div class="modal-body">

            <input type="text"  name="product1" value="{{item.product}}"  hidden>
            <!-- <input type="text"  name="refnumber" value="{{servicerefnumber}}"  > -->
            <input type="text" class="form-control text-center" value="Reassigned"  name="status" id="status" hidden>
            <div class="form-group">
                <label for="brand" class="fw-bold">Service ref No.</label>
                

                <input type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" readonly>
              </div>
            

              <div class="form-group">
                <label for="brand" class="fw-bold">Technician</label>
                
                <select class="form-control selectizefield " name="technician" id="technician" style="border:1px solid #cccccc;box-shadow: inset 0 1px 1px #00000013;">
                    <option value="{{technician.username}}" selected>{{technician}}</option>
                    {% for technicians in technician_list_new %}
                    <option value="{{technicians.username}}">{{technicians.username}} - {{technicians.pending}} Pending</option>
                    {% endfor %}
                    
                                  </select>
                
              </div>

           </div>
           <div class="modal-footer">
             <button type="submit" class="btn btn-primary">Save</button>
           </div>
        </form>
      </div>
    </div>
  </div>












  <div class="modal fade " tabindex="-1" id="exampleModalLong">
    <div class="modal-dialog ">
      <div class="modal-content p-0 w-100">
        <div
          class="modal-header bg-color-modal text-white d-flex justify-content-between align-items-center m",
          style="background-color:#4555B9;"
        >
          <h5 class="modal-title"><strong>Service History</strong></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span class="text-white" aria-hidden="true">&times;</span>
           </button>
        </div>
      
       
          <div class="modal-body">

          

            <!-- <ul class="list-group list-group-flush " style="text-align:left;">
              
              {% for history in service_history %}
              <li class="list-group-item ">- {{history.description}}</li>
              {% endfor %}
            </ul> -->

            <ul style="text-align:left;font-family:Roboto;">
              {% for history in service_history %}
              <li class="pt-1 pb-1" >{{history.description}}</li>
              {% endfor %}
            </ul>


           </div>
           <!-- <div class="modal-footer " style="background-color:#4555B9;">
             
           </div> -->
    
      </div>
    </div>
  </div>












                <div class="modal fade" tabindex="-1" id="servicerejectmodal">
                    <div class="modal-dialog">
                      <div class="modal-content w-100">
                        <div
                          class="modal-header d-flex justify-content-between align-items-center m"
                        >
                          <h5 class="modal-title"><strong>Reject Reason</strong></h5>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                             <span aria-hidden="true">&times;</span>
                           </button>
                        </div>
                      
                        <form action="{% url 'serviceupdate'  %}" method="POST">
                          {% csrf_token %}
                          <div class="modal-body">
                
                            <input type="text"  name="product1" value="{{item.product}}"  hidden>
                            
                            <input type="text" class="form-control text-center" value="Rejected"  name="status" id="status" hidden>
                            <input hidden type="text" class="form-control text-center" value="{{servicerefnumber}}"  name="refnumber" id="refnumber" hidden>


                            <div class="form-group">
                                <label for="rejectreason" class="fw-bold">Reject Reason</label>
                            <textarea class="form-control text-center" style="height:106px;" value="{{reject_reason}}" name="rejectreason" id="rejectreason"  cols="30" rows="10">{{reject_reason}}</textarea>
                            </div>
                
                              
                
                           </div>
                           <div class="modal-footer">
                             <button type="submit" class="btn btn-primary">Reject</button>
                           </div>
                        </form>
                      </div>
                    </div>
                  </div>


                  <script>
//                     document.addEventListener('DOMContentLoaded', () => {



//   const canvas = document.getElementById('lockCanvas');
//   const ctx = canvas.getContext('2d');
//   const patternLock = document.getElementById('patternLock');
//   const lockButtons = document.querySelectorAll('.lock-btn');
//   const patternStr = '{{pattern | safe}}';

  
//   const predefinedPattern = patternStr.split('>').map(Number);


//   // Initialize canvas size
//   canvas.width = patternLock.offsetWidth;
//   canvas.height = patternLock.offsetHeight;

//   function getButtonCenter(num) {
//     const btn = document.querySelector(`.lock-btn[data-num="${num}"]`);
//     const rect = btn.getBoundingClientRect();
//     return {
//       x: rect.left + rect.width / 2 - patternLock.offsetLeft,
//       y: rect.top + rect.height / 2 - patternLock.offsetTop
//     };
//   }

//   function drawLine(from, to) {
//     console.log("Drawing from", from, "to", to); // Debugging line positions
//     ctx.beginPath();
//     ctx.moveTo(from.x, from.y);
//     ctx.lineTo(to.x, to.y);
//     ctx.strokeStyle = '#4CAF50'; 
//     ctx.lineWidth = 4; 
//     ctx.stroke();
// }


//   function displayPattern(patternIn) {
//     patternIn.forEach((num, index) => {

//       const btn = document.querySelector(`.lock-btn[data-num="${num}"]`);
//       btn.classList.add('active');

     
//       if (index < patternIn.length - 1) {
//         const fromCenter = getButtonCenter(num);
//         const toCenter = getButtonCenter(patternIn[index + 1]);
//         drawLine(fromCenter, toCenter);
//       }
//     });
//   }

//   displayPattern(predefinedPattern);
// });





document.addEventListener('DOMContentLoaded', () => {
  const lockButtons = document.querySelectorAll('.lock-btn');
  const patternLock = document.getElementById('patternLock');
  // const predefinedPattern = [1, 2, 3, 5, 7, 8]; 
  const patternStr = '{{pattern | safe}}';

  
const predefinedPattern = patternStr.split('>').map(Number);
  // Function to create and position a line
  function createLine(x1, y1, x2, y2) {
    const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
    const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
    const line = document.createElement('div');
    line.className = 'line';
    line.style.width = `${length}px`;
    line.style.transform = `rotate(${angle}deg)`;
    line.style.position = 'absolute';
    // Adjust positioning based on the patternLock container's position
    const patternRect = patternLock.getBoundingClientRect();
    line.style.top = `${y1 - patternRect.top}px`;
    line.style.left = `${x1 - patternRect.left + window.scrollX}px`;

    return line;
  }

  // Function to draw the pattern with lines
  function drawPattern(pattern) {
    pattern.forEach((num, index) => {
      // Highlight the button
      lockButtons[num - 1].classList.add('active');

      if (index < pattern.length - 1) {
        const startBtn = lockButtons[num - 1];
        const endBtn = lockButtons[pattern[index + 1] - 1]; // Fix to access the next item in the pattern

        const startRect = startBtn.getBoundingClientRect();
        const endRect = endBtn.getBoundingClientRect();

        const startX = startRect.left + startRect.width / 2;
        const startY = startRect.top + startRect.height / 2;
        const endX = endRect.left + endRect.width / 2;
        const endY = endRect.top + endRect.height / 2;

        const line = createLine(startX, startY, endX, endY);
        // Append line to the patternLock container or another suitable container
        patternLock.appendChild(line); // Changed from document.body
      }
    });
  }

  drawPattern(predefinedPattern);
});

                  </script>






{% endblock %}